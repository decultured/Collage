<?xml version="1.0" encoding="utf-8"?> 
<mx:WindowedApplication xmlns:mx="http://www.adobe.com/2006/mxml" xmlns:clg="Collage.*" layout="absolute" creationComplete="init()">
	<mx:Style> 
		WindowedApplication
		{
			background-color:"0x000000";
			background-alpha:"1.0";
		}
	</mx:Style>
	<mx:Script>
		<![CDATA[
		import mx.controls.Alert;
		import mx.controls.Image;
		import flash.filesystem.File;
		import mx.managers.PopUpManager;
		import mx.containers.TitleWindow;
		import Collage.Snippet.*;
		import Collage.Components.Picture;
		import com.roguedevelopment.objecthandles.HandleDescription;
		import com.roguedevelopment.objecthandles.HandleRoles;
		import com.roguedevelopment.objecthandles.ObjectHandles;
		import com.roguedevelopment.objecthandles.constraints.MovementConstraint;
		import com.roguedevelopment.objecthandles.constraints.SizeConstraint;

		protected var _ObjectHandles:ObjectHandles;

		
		private function init():void{
			this.addEventListener(NativeDragEvent.NATIVE_DRAG_ENTER,onDragIn);
			this.addEventListener(NativeDragEvent.NATIVE_DRAG_DROP,onDrop);
			_ObjectHandles = new ObjectHandles(this);
		}

		private function onDragIn(event:NativeDragEvent):void{
		  NativeDragManager.acceptDragDrop(this);
		}

		private function onDrop(event:NativeDragEvent):void{
		  var dropfiles:Array = event.clipboard.getData(ClipboardFormats.FILE_LIST_FORMAT) as Array;
		  for each (var file:File in dropfiles){
		    switch (file.extension.toLowerCase()){
		      case "png" :
				addImage(file, event.localX, event.localY);
				break;
		      case "jpg" :
		        addImage(file, event.localX, event.localY);
		        break;
		      case "jpeg" :
		        addImage(file, event.localX, event.localY);
		        break;
		      case "gif" :
		        addImage(file, event.localX, event.localY);
		        break;
		      default:
		        Alert.show("Unmapped Extension");
		      }
		    }
		  }

		private function addImage(file:File, xPos:Number, yPos:Number):void
		{
			var newPicture:Picture = new Picture();
			_ObjectHandles.registerComponent(newPicture.model, newPicture);
			addChild(newPicture);

			newPicture.url = file.url;
		  }
       ]]>
    </mx:Script>
</mx:WindowedApplication>